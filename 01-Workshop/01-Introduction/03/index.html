
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Workshop on using Reasoning models with Azure AI Foundry">
      
      
        <meta name="author" content="Nitya Narasimhan">
      
      
        <link rel="canonical" href="https://microsoft.github.io/Build25-Lab333/01-Workshop/01-Introduction/03/">
      
      
        <link rel="prev" href="../02/">
      
      
        <link rel="next" href="../../02-Ideation/01/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Lab 4: Manage Tokens - MSBuild 2025 - Lab 333</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-4-manage-tokens" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MSBuild 2025 - Lab 333" class="md-header__button md-logo" aria-label="MSBuild 2025 - Lab 333" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MSBuild 2025 - Lab 333
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 4: Manage Tokens
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/Build25-lab333" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/Build25-lab333
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../00-Setup/00-self-guided/" class="md-tabs__link">
          
  
  
    
  
  01 Workshop

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../02-Homework/Implementation/" class="md-tabs__link">
          
  
  
    
  
  02 Homework

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MSBuild 2025 - Lab 333" class="md-nav__button md-logo" aria-label="MSBuild 2025 - Lab 333" data-md-component="logo">
      
  <img src="../../../assets/logo.svg" alt="logo">

    </a>
    MSBuild 2025 - Lab 333
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/Build25-lab333" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/Build25-lab333
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    01 Workshop
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            01 Workshop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    00 Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            00 Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-Setup/00-self-guided/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1: Setup AI Project
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00-Setup/01-explore-project/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 2: Validate Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 Introduction
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            01 Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reasoning Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3: Compare Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab 4: Manage Tokens
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab 4: Manage Tokens
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reasoning-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Reasoning Tokens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-management" class="md-nav__link">
    <span class="md-ellipsis">
      Token Management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-time-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      Inference Time Scaling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-visual-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      Task: Visual Reasoning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-o4-mini-low100k" class="md-nav__link">
    <span class="md-ellipsis">
      1. o4-mini (low)(100K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-o4-mini-high100k" class="md-nav__link">
    <span class="md-ellipsis">
      2. o4-mini (high)(100k)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-o1-high40k" class="md-nav__link">
    <span class="md-ellipsis">
      3. o1 (high)(40K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-o1-high4k" class="md-nav__link">
    <span class="md-ellipsis">
      4. o1 (high)(4K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-o1-low4k" class="md-nav__link">
    <span class="md-ellipsis">
      5. o1 (low)(4K)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 Ideation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            02 Ideation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Ideation/01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 5 · Prompt Engineering
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-Ideation/02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 6 · Visual Reasoning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    03 Inference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            03 Inference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Inference/01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 7 · Code-First Prompting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Inference/02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 8 · Advanced Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-Inference/03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Continue Learning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02 Homework
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            02 Homework
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../02-Homework/Implementation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Implementation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Implementation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../02-Homework/Implementation/01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application Patterns
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../02-Homework/Implementation/02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 9 · Metaprompting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../02-Homework/Implementation/03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 10 · Model Chaining
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../02-Homework/References/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reasoning-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      Reasoning Tokens
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#token-management" class="md-nav__link">
    <span class="md-ellipsis">
      Token Management
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inference-time-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      Inference Time Scaling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#task-visual-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      Task: Visual Reasoning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Instructions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lab Instructions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-o4-mini-low100k" class="md-nav__link">
    <span class="md-ellipsis">
      1. o4-mini (low)(100K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-o4-mini-high100k" class="md-nav__link">
    <span class="md-ellipsis">
      2. o4-mini (high)(100k)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-o1-high40k" class="md-nav__link">
    <span class="md-ellipsis">
      3. o1 (high)(40K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-o1-high4k" class="md-nav__link">
    <span class="md-ellipsis">
      4. o1 (high)(4K)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-o1-low4k" class="md-nav__link">
    <span class="md-ellipsis">
      5. o1 (low)(4K)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="lab-4-manage-tokens">Lab 4: Manage Tokens<a class="headerlink" href="#lab-4-manage-tokens" title="Permanent link">&para;</a></h1>
<div class="admonition quote">
<p class="admonition-title">BY THE END OF THIS SECTION YOU SHOULD KNOW</p>
<ol>
<li>What reasoning tokens are, and how they relate to inference time scaling</li>
<li>Why token management is critical, and the levers available to influence it </li>
<li>How to use a trial and error approach to find the right token management strategy</li>
</ol>
</div>
<hr />
<p>Reasoning models are designed to think deep and hard about complex problems - where precision and accuracy of responses are a higher priority. The tradeoff we make is in <em>response latency</em> and <em>token usage</em>. In this section, we'll see where these reasoning overheads occur, and what knobs and dials we have to optimize them.</p>
<h2 id="reasoning-tokens">Reasoning Tokens<a class="headerlink" href="#reasoning-tokens" title="Permanent link">&para;</a></h2>
<p>Reasoning models work by introducing the idea of <a href="https://platform.openai.com/docs/guides/reasoning#how-reasoning-works">reasoning tokens</a> as shown below. </p>
<ol>
<li>These tokens represent the "thinking output" of the model at a given step (turn) </li>
<li>Tokens are not carried over, but they count against the model context window.</li>
<li>Increasing the count of reasoning tokens encourages model to "think more"</li>
<li>
<p>Increasing it too much can cause it to starve output tokens (reducing quality)</p>
<p><img alt="Tokens" src="../../assets/01-intro-token-window.png" /></p>
</li>
</ol>
<hr />
<h2 id="token-management">Token Management<a class="headerlink" href="#token-management" title="Permanent link">&para;</a></h2>
<p>So how do we we strike the right balance between reasoning accuracy (more reasoning tokens) and output quality (fewer reasoning tokens)? We have a few knobs we can turn:</p>
<ol>
<li>Set <a href="https://platform.openai.com/docs/guides/reasoning?api-mode=chat#controlling-costs">max_completion_tokens</a> to limit the total number of tokens generated per turn - including both <em>visible</em> (output) and <em>hidden</em> (reasoning) tokens.</li>
<li>Set <a href="https://platform.openai.com/docs/guides/reasoning?api-mode=chat#get-started-with-reasoning">reasoning_effort</a> to <code>low</code>, <code>medium</code>, or <code>high</code> based on your requirements. The default is medium - allowing you to move the dial up or down, to optimize for accuracy or cost.</li>
<li>Try different reasoning models (e.g., old-vs-new, full-vs-mini). The token cost or response quality may vary even if all other parameters are the same.</li>
</ol>
<p>This may require trial-and-error strategies. We'll see an example in practice below.</p>
<hr />
<h2 id="inference-time-scaling">Inference Time Scaling<a class="headerlink" href="#inference-time-scaling" title="Permanent link">&para;</a></h2>
<p>Let's briefly talk about <strong>inference time scaling</strong> and how it relates to reasoning effort.</p>
<ol>
<li><strong>Training time compute</strong> refers to the time and resources needed to train the LLM to do reasoning. Training compute is expensive. So, even though increasing training time improves performance, we cannot afford to do so at will (e.g., for specific tasks)</li>
<li><strong>Inference time compute</strong> refers to the time and resources needed to execute a request with that trained model. Inference compute is cheaper than training, and data indicates that giving models more time to think (inference time) may lead to better performance. This makes inference time scaling the more cost-effective way to adapt and grow performance.</li>
</ol>
<p>Reasoning models can use various strategies to scale inference time, including:</p>
<ul>
<li>Increasing count of reasoning tokens (give it more space to think)</li>
<li>Asking the model to wait (and assess status before it continues)</li>
<li>Asking the model to explore strategies in parallel (encourage more thought)</li>
</ul>
<hr />
<h2 id="task-visual-reasoning">Task: Visual Reasoning<a class="headerlink" href="#task-visual-reasoning" title="Permanent link">&para;</a></h2>
<p>Let's revisit the <a href="https://openai.com/index/introducing-o3-and-o4-mini/">visual reasoning example</a> in the o4-mini release announcement. The use case involves this image of a person holding up a picture with a tour schedule - and uses this prompt: </p>
<div class="admonition quote">
<p>It's 12, I've already seen #4, 
output a planning that will make sure I see all attractions and shows, 
taking into account their duration (1st column) 
and a 10 minute buffer between each show.</p>
</div>
<p><img alt="Image" src="../../assets/example-o1.webp" /></p>
<p>To explore the levers available to us for token management, let's start with a Playground exercise where we adjust three levers: <em>reasoning effort, max completion tokens, and choice of reasoning model.</em></p>
<p>We have two reasoning model deployments in our Azure AI Foundry project: <code>o1</code> and <code>o4-mini</code>. </p>
<p>Both models can handle multimodal inputs, so let's try to figure out which one is best for a <em>visual reasoning</em> task based on the tradeoffs between token cost and accuracy. Note that the model is not just describing the picture, it is actively reasoning about how to use that information to fulfill the user's objective.</p>
<h2 id="lab-instructions">Lab Instructions<a class="headerlink" href="#lab-instructions" title="Permanent link">&para;</a></h2>
<ol>
<li>You'll find a copy of this image here: <code>docs/Workshop/assets/example-o1.webp</code>. Save the image to your laptop by right-clicking on the image shown above and using the "Save As" action.</li>
<li>Use the Azure AI Foundry Playground to test the prompt with each of the models <code>o1</code> and <code>o4-mini</code> in turn</li>
<li>In each step, copy the prompt above into the prompt box (top left)</li>
<li>Click the paperclip icon in the prompt box to upload the image above</li>
<li>Open the "Parameters" control to set the reasoning effort to the desired level (low, medium, high)</li>
<li>Set the max completion tokens to the desired length (100K, 40K, 4K)</li>
<li>Run the prompt and observe the response and token usage </li>
</ol>
<p>Detailed steps are provided for each model / reasoning effort combination below.</p>
<div class="admonition info">
<p class="admonition-title"><strong>Based on your observations -  what do you feel is the best model for this task?</strong></p>
</div>
<h3 id="1-o4-mini-low100k">1. o4-mini (low)(100K)<a class="headerlink" href="#1-o4-mini-low100k" title="Permanent link">&para;</a></h3>
<ol>
<li>Use the faster, cheaper o4-mini model with the default max completion tokens (100K)</li>
<li>Set reasoning effort to low</li>
<li><strong>Response</strong> took 632 tokens</li>
</ol>
<p><img alt="Image" src="../../assets/visual-1-o4mini-low.png" /></p>
<h3 id="2-o4-mini-high100k">2. o4-mini (high)(100k)<a class="headerlink" href="#2-o4-mini-high100k" title="Permanent link">&para;</a></h3>
<ol>
<li>Set reasoning effort to high</li>
<li><strong>Response</strong> took 642 tokens</li>
<li><em>We observe that changing reasoning effort did not improve performance much. This may be because the model was able to get the best answer with the default reasoning effort.</em></li>
</ol>
<p><img alt="Image" src="../../assets/visual-2-o4mini-high.png" /></p>
<h3 id="3-o1-high40k">3. o1 (high)(40K)<a class="headerlink" href="#3-o1-high40k" title="Permanent link">&para;</a></h3>
<ol>
<li>Change models to o1 (old-vs-new)(full-vs-mini)</li>
<li>Note that o1 suggests lower completion tokens (40K) by default</li>
<li>Note that o1 also lacks the <em>Generate Summary</em> parameter</li>
<li><em>We observe that the model uses more tokens but takes additional effort to provide tips.</em></li>
</ol>
<p><img alt="Image" src="../../assets/visual-3-o1-high-40k.png" /></p>
<h3 id="4-o1-high4k">4.  o1 (high)(4K)<a class="headerlink" href="#4-o1-high4k" title="Permanent link">&para;</a></h3>
<ol>
<li>Let's lower the max completion tokens to 4K</li>
<li>Note that this impacts model's ability to think - no response is generated</li>
</ol>
<p><img alt="Image" src="../../assets/visual-4-o1-high-4k.png" /></p>
<h3 id="5-o1-low4k">5. o1 (low)(4K)<a class="headerlink" href="#5-o1-low4k" title="Permanent link">&para;</a></h3>
<ol>
<li>Keep the max completion tokens at 4K</li>
<li>Set reasoning effort to low</li>
<li>We do get a response - but it's the most tokens used so far.</li>
</ol>
<p><img alt="Image" src="../../assets/visual-5-o1-low-4k.png" /></p>
<hr />
<div class="admonition tip">
<p class="admonition-title">The main takeaway is to experiment with different models and parameters to find the right balance for your use case. In this case, we see that o4-mini with default (high reasoning) has the best value.</p>
</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../02/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab 3: Compare Models">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab 3: Compare Models
              </div>
            </div>
          </a>
        
        
          
          <a href="../../02-Ideation/01/" class="md-footer__link md-footer__link--next" aria-label="Next: Lab 5 · Prompt Engineering">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Lab 5 · Prompt Engineering
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 Microsoft &nbsp;|&nbsp; <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy </a>&nbsp;|&nbsp; <a href="https://go.microsoft.com/fwlink/?LinkId=2259814">Consumer Health Privacy </a>&nbsp;|&nbsp; <a onclick="window.manageConsent();">Cookies </a>&nbsp;|&nbsp; <a href="https://go.microsoft.com/fwlink/?LinkID=206977">Terms of Use </a>&nbsp;|&nbsp; <a href="https://www.microsoft.com/trademarks">Trademarks </a>

    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.expand", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.indexes", "navigation.top", "toc.follow", "navigation.footer", "content.code.copy", "content.tabs.link"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>